Это набор скриптов для удалённого запуска смешнявок (картинки, программы, звуки) на электронной доске через Telegram-бота.
50% работы взял на себя: https://github.com/SRLQNL

ТРЕБУЕТСЯ ДЛЯ РАБОТЫ: ПК и Python, установленный и добавленный в переменную среды PATH

Раздел 1 - Установка бота и клиента (удалённого ПК/доски):

Пункт 1 "Пинкод" и "Задержка клиента":

1)В качестве защиты от DDoS-атак на бота и соответственно от перехвата управления, добавлен пинкод.
2)Google установил квоту на использование API в минуту. Опытным путём было выяснено, что один парсинг каждые 3 секунды входит в квоту. На свой страх и риск можно установить значение ниже.
FAQ:
1)Как уменьшить/увеличить задержку выполнения команд? - Задержку можно изменить, изменив число (секунды) после "delay =". Кавычки не убирайте, иначе программа выдаст ошибку.
2)Как поменять пинкод? - Пинкод можно изменить, изменив число после "_pin=".
3)Какие правила установки пинкода? - Пинкод должен быть целочисленным (int) без точек.
4)Можно ли убрать пинкод? - Убрать пинкод через конфиг нельзя (опытные пользователи могут убрать его на уровне кода) в целях безопасности.
5)Какой пинкод по умолчанию? - Изначально пинкод установлен равным 1.

Пункт 2 "Токен бота и сам Бот":

Создать бота, а соответственно получить токен можно через Telegram-бота @BotFather.

1)Заходим в Telegram к боту @BotFather и нажимаем на /start.
2)Вводим или нажимаем на /newbot.
3)Придумываем имя.
3)Придумываем username. Username должен быть написан латиницей и заканчиваться на "_bot", например, "test_bot". Запоминаем этот username, так как через него будет происходить переход в чат к боту.
4)Получаем токен.

Пункт 3 "ID таблицы и таблица":

1)Открываем Google Sheets (таблицы) и создаём таблицу. Ничего не меняем!!! Для правильного копирования ссылки нажимаем на "Настройки доступа" и выбираем в пункте прав на изменение таблицы "Все, у кого есть ссылка". Ниже нажимаем кнопку "Копировать ссылку".
2)Открываем блокнот и вставляем ссылку. ID таблицы находится в ссылке на таблицу (ID находится после d/ и до /edit, в моём случае - 1RKFthr5TGKE5BCUBmNdRJgH-vPfgh_bj).

!!!Ничего, кроме того, что сказано в README, не трогайте, что связано с таблицей и её настройками!!!

Пункт 4 "GOOGLE API":

1) Входим на сайт cloud.google.com и нажимаем "console".
2) В списке стран выбираем "United States" и соглашаемся с условиями пользования.
3) Нажимаем на "Select a project", затем на "New Project".
4) Создаём подходящее название, например, "python", и нажимаем "Create".
5) Выбираем созданный проект через меню "Select a project".
6) Нажимаем на три полоски и в списке выбираем "APIs & Services", далее выбираем "Library".
7) В поиске вводим "Google Sheets API" и выбираем Google таблицы.
8) В разделе "Product details" от "Google Sheets API" нажимаем "Enable".
9) В открытом меню управления "Google Sheets API" нажимаем на "Credentials", далее "Create credentials" и выбираем "Service Account".
10) Создаём два аккаунта с именами и ID "server" и "client" соответственно. Второй и третий разделы создания аккаунта пропускаем.
11) В результате получаем два сервисных аккаунта с двумя почтами.
12) Переходим в таблицу, которую создали в пункте 3 данного раздела "Установка бота и клиента (удалённого ПК/доски)".
13) Нажимаем на "Настройки доступа" и добавляем в качестве редактора две почты сервисных аккаунтов (может возникнуть ошибка, прокликайте кнопку несколько раз).
14) Возвращаемся к консоли Google.
15) Нажимаем на первую почту, в моём случае - client.
16) Переходим в раздел "Keys" и нажимаем "Add key", затем "Create a new Key", после выбираем "JSON" и скачиваем файл с названием client/server (в зависимости от выбранной вами почты в пункте 15).
17) Делаем то же самое и со второй почтой, в моём случае - server.
18) Получаем на выходе два JSON файла. Один от сервисной учётной записи "server", другой от "client".


Раздел 2 - Сборка и установка всего для проекта

Пункт 0 "Подготовительный":

1)В одну папку n закидываем два JSON файла и запоминаем/записываем ID таблицы и токен бота (таблица - раздел 1 пункт 3 подпункт 2, бот - раздел 1, пункт 2 подпункт 5).

Пункт 1 "Сборка файлов клиента":

1)В папку n скачиваем и распаковываем репозиторий с GitHub (Code->Download zip), игнорируем README.md!
2)Заходим в папку client (Эта папка пойдёт в будущем на доску, которая будет "жертвой"). Закидываем JSON клиента в папку с .py скриптами. Открываем main.py через блокнот и заполняем:
2.1) В переменную account_file между кавычками вводим наш путь к JSON файлу (в нашем примере просто НАЗВАНИЕ.JSON).
2.2) В переменную spreadsheet_id между кавычками вводим наш ID таблицы.
2.3) Delay лучше не трогать.

Пункт 2 "Сборка файлов сервера":

1) Заходим в папку server (Эта папка пойдёт в будущем на ПК/хостинг для запуска бота). Закидываем JSON сервера в папку с .py скриптами. Открываем main.py через блокнот и заполняем:
1.1) В переменную account_file между кавычками вводим наш путь к JSON файлу (в нашем примере просто НАЗВАНИЕ.JSON).
1.2) В переменную spreadsheet_id между кавычками вводим наш ID таблицы.
1.3) В переменную _pin после равно вводим наш пинкод и запоминаем его.
1.4) В переменную token между кавычками вводим наш токен Telegram-бота.
Не забываем сохраняться.

Пункт 3 "Библиотеки":

1) Для сервера (ПК/хостинг для запуска бота) вводим в терминал (на Windows - cmd, на Linux - обычно terminal) ПОСЛЕДОВАТЕЛЬНО:
1.1) pip install --upgrade google-api-python-client
1.2) pip install telebot
!!!ВАЖНО: НА ЛИНУКСЕ ВМЕСТО pip ПИШИТЕ pip3

Пункт 4 "Запуск бота и скрипта на доске"

2) Начнём с бота. Его лучше запускать на другом ПК (можно на вашем из дома).
3) Дважды кликните на main.py, который находится в папке server.
3) Если у вас вылезло пустое окно, то всё ок. Переходите к боту через Telegram и напишите /start для проверки работоспособности.
4) Готово! Бот работает.
!!!ВАЖНО: ЕСЛИ ВЫ ВЫКЛЮЧИТЕ ПК/СКРИПТ, ТО БОТ ТОЖЕ ПЕРЕСТАНЕТ РАБОТАТЬ

1) Доска. Закидываем подготовленные файлы из папки client на флешку и вставляем в доску.
2) Перекидываем папку с файлами на доску (желательно не на рабочий стол).
3) Открываем папку и нажимаем ПКМ->открыть в терминале.
4) Прописываем:
6) python3 main.py
7) Если вылезает ошибка типа: No Module Found 'какой-то модуль', то доустанавливаем:
8) pip3 install какой-то модуль
9) Скрываем окно терминала, НЕ ЗАКРЫВАЕМ

!!!ВАЖНО: ЕСЛИ ВЫ ВЫКЛЮЧИТЕ ДОСКУ/СКРИПТ, ТО СКРИПТ ТОЖЕ ПЕРЕСТАНЕТ РАБОТАТЬ

Всё готово! Если вы в школе 1584 старшего корпуса, могу за дополнительную плату установить/решить проблему за вас на доске (договариваться через Telegram: @KrackF1).
